# React Fiber 机制

- 组件比较多，组件树（树状组件）深度深
  每个组件都要经历 JSX 模板的编译，CDOM 的创建，响应式的生命、生命周期，挂载等
  核心问题：
    1. react组件渲染是同步代码，会阻塞主线程，但是我们有更重要的任务要做
    2. 用户交互（如点击按钮）可能被后台任务（如数据渲染）阻塞，降低用户体验
    3. 无法动态调整任务优先级或暂停低优先级任务
  怎么办？
    1. 打断一下，让浏览器响应用户更优先的去做，到时候再回来接着执行


- fiber 机制是 React 16 版本引入的重写核心算法，实现了可中断渲染

  - 以前学习过什么api类fiber？
    可打断可持续
    requestAnimationFrame
      用于动画，不是一直执行的，1s执行60次，让用户交互成为更优先执行的操作
      是浏览器提供的用于在下一次重绘之前执行动画代码的API，它能确保动画流畅运行并节省资源。

    requestIdleCallback
      渲染低优先级任务，更高优先级的任务是用户的交互
      将react组件树的渲染任务拆分
        在一个时间切片里面能执行完，这个时间长度用requestIdleCallback来描述

      用于空闲时间执行任务，不是一直执行的，空闲时执行
      是浏览器提供的用于在浏览器空闲时执行任务的API，它能确保在浏览器空闲时执行任务，从而提高页面性能。
      
## 总结：
  - react 组件多，组件树深度大，渲染耗时，用requestIdleCallback 中断渲染
  - 优先响应界面交互和核心任务
  - 当再次idle后，继续执行渲染任务
  - requestIdleCallback 时间不定，16.67ms(刷帧)- 优先任务的耗时=本次执行实际执行时间
  没有fiber react 组件一多，就会卡，fiber解决性能问题，主要通过中断污染，保障用户交互流畅，解决大型项目阻塞主线程的问题
